#!/bin/bash

[[ -f ~/.config/user-dirs.dirs ]] && source ~/.config/user-dirs.dirs
OUTPUT_DIR="${OMARCHY_SCREENSHOT_DIR:-${XDG_PICTURES_DIR:-$HOME/Pictures}}"

if [[ ! -d "$OUTPUT_DIR" ]]; then
  notify-send "Screenshot directory does not exist: $OUTPUT_DIR" -u critical -t 3000
  exit 1
fi

# Use flameshot for screenshots
case ${1:-region} in
  "region")
    flameshot gui --path "$OUTPUT_DIR"
    ;;
  "window")
    # Wait a moment then take window screenshot
    sleep 0.5
    flameshot screen --path "$OUTPUT_DIR"
    ;;
  "output"|"screen")
    flameshot full --path "$OUTPUT_DIR"
    ;;
  *)
    flameshot gui --path "$OUTPUT_DIR"
    ;;
esac
