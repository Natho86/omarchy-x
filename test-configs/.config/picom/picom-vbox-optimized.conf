# VirtualBox-optimized picom configuration
# Balances visual appeal with VirtualBox compatibility
# Keeps lightweight effects, removes problematic transparency and blur

# Shadows - KEPT (lightweight and adds visual depth)
shadow = true;
shadow-radius = 8;          # Slightly smaller than original (10 → 8)
shadow-offset-x = -6;       # Smaller offset (original -8)
shadow-offset-y = -6;       # Smaller offset (original -8)
shadow-opacity = 0.3;       # Slightly more transparent (original 0.4)
shadow-color = "#000000";

shadow-exclude = [
  "name = 'Notification'",
  "class_g = 'Conky'",
  "class_g ?= 'Notify-osd'",
  "class_g = 'Cairo-clock'",
  "class_g = 'firefox' && argb",
  "class_g = 'Polybar'",     # Don't shadow the status bar
  "_GTK_FRAME_EXTENTS@:c"
];

# Fading - KEPT (smooth, lightweight animation)
fading = true;
fade-in-step = 0.03;         # Slightly faster than original (0.05 → 0.03)
fade-out-step = 0.03;        # Faster fade for better responsiveness
fade-delta = 6;              # Smaller delta (original 8)

# Transparency / Opacity - REMOVED/SIMPLIFIED
# This was the main cause of terminal issues
inactive-opacity = 1.0;     # No transparency (was 0.95)
frame-opacity = 1.0;         # No frame transparency (was 0.9)
active-opacity = 1.0;        # Keep all windows fully opaque
inactive-opacity-override = false;

# NO opacity rules - this was causing terminal display issues
# opacity-rule = []; # Completely removed

# Background-Blurring - REMOVED (too heavy for VirtualBox)
# blur section completely removed

# General Settings - VirtualBox optimized
backend = "xrender";         # Better VirtualBox compatibility (was "glx")
vsync = false;               # Reduce lag in VirtualBox (was true)
mark-wmwin-focused = true;
mark-ovredir-focused = true;
detect-rounded-corners = false;  # Disable to reduce overhead (was true)
detect-client-opacity = false;   # Disable to prevent transparency issues (was true)
detect-transient = true;
detect-client-leader = true;
use-damage = true;
log-level = "warn";

# Window type settings - simplified, no transparency
wintypes: {
  tooltip = { fade = true; shadow = true; opacity = 1.0; focus = true; full-shadow = false; };
  dock = { shadow = false; clip-shadow-above = true; };
  dnd = { shadow = false; };
  popup_menu = { opacity = 1.0; shadow = false; };     # No shadow for menus (reduce overhead)
  dropdown_menu = { opacity = 1.0; shadow = false; };  # No shadow for menus
  above = { shadow = true; };
  splash = { shadow = false; };
  utility = { focus = true; shadow = false; };
  notification = { shadow = false; };
  desktop = { shadow = false; };
  menu = { focus = true; };
  dialog = { shadow = true; };
  normal = { shadow = true; };
  terminal = { opacity = 1.0; fade = true; shadow = true; };  # Explicitly set terminal settings
};